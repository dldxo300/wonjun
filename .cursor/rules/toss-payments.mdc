---
description: Cursor IDEì—ì„œ MCPë¥¼ í™œìš©í•œ í† ìŠ¤í˜ì´ë¨¼ì¸  í†µí•© ê°€ì´ë“œ. ì´ ê·œì¹™ì€ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤, ì—ëŸ¬ ì²˜ë¦¬, ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ì„ í¬í•¨í•œ í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ì‹œìŠ¤í…œ í†µí•©ì„ ìœ„í•œ í¬ê´„ì ì¸ ê°€ì´ë“œë¼ì¸ì„ ì œê³µí•©ë‹ˆë‹¤.
globs: **/*.js,**/*.jsx,**/*.ts,**/*.tsx,**/payment/**,**/checkout/**
alwaysApply: false
---

# í† ìŠ¤í˜ì´ë¨¼ì¸  ì—°ë™ ê°€ì´ë“œ for Cursor

ì´ ë¬¸ì„œëŠ” Cursor IDEì—ì„œ MCP (Model Context Protocol) ì§€ì›ì„ í™œìš©í•˜ì—¬ í† ìŠ¤í˜ì´ë¨¼ì¸ ë¥¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì— í†µí•©í•˜ëŠ” í¬ê´„ì ì¸ ê°€ì´ë“œë¼ì¸ì„ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ¯ í•µì‹¬ í†µí•© ì›ì¹™

### ë°˜ë“œì‹œ ë”°ë¼ì•¼ í•  ê·œì¹™:
1. **ë³´ì•ˆ ìš°ì„ **: í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì—ì„œ ì‹œí¬ë¦¿ í‚¤ë¥¼ ì ˆëŒ€ ë…¸ì¶œí•˜ì§€ ì•Šê¸°
2. **ì—ëŸ¬ ì²˜ë¦¬**: ê²°ì œ í”Œë¡œìš°ì— ëŒ€í•œ í¬ê´„ì ì¸ ì—ëŸ¬ ì²˜ë¦¬ êµ¬í˜„í•˜ê¸°
3. **ê²€ì¦**: í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ ì–‘ìª½ì—ì„œ ëª¨ë“  ê²°ì œ ë°ì´í„° ê²€ì¦í•˜ê¸°
4. **ì‚¬ìš©ì ê²½í—˜**: ê²°ì œ í”„ë¡œì„¸ìŠ¤ì˜ ëª¨ë“  ë‹¨ê³„ì—ì„œ ëª…í™•í•œ í”¼ë“œë°± ì œê³µí•˜ê¸°
5. **ë¬¸ì„œ ì°¸ì¡°**: ê³µì‹ í† ìŠ¤í˜ì´ë¨¼ì¸  ë¬¸ì„œ ì°¸ì¡° https://docs.tosspayments.com

## ğŸ“¦ ì„¤ì¹˜ ë° ì„¤ì •

### í•„ìˆ˜ ì˜ì¡´ì„±

```bash
# ê²°ì œìœ„ì ¯ìš© (ê¶Œì¥)
npm install @tosspayments/payment-widget-sdk

# ê²°ì œì°½ìš© (ëŒ€ì•ˆ)
npm install @tosspayments/payment-sdk

# ë¸Œëœë“œí˜ì´ìš© (ìì²´ ê°„í¸ê²°ì œ)
npm install @tosspayments/brandpay-sdk
```

### í™˜ê²½ ë³€ìˆ˜

ë¯¼ê°í•œ í‚¤ëŠ” ë°˜ë“œì‹œ í™˜ê²½ ë³€ìˆ˜ì— ì €ì¥í•˜ì„¸ìš”:

```bash
# .env.local (ì´ íŒŒì¼ì€ ì ˆëŒ€ ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš”)
NEXT_PUBLIC_TOSS_CLIENT_KEY=test_ck_XXXXXXXXXXXXX  # í´ë¼ì´ì–¸íŠ¸ í‚¤ (ê³µê°œ)
TOSS_SECRET_KEY=test_sk_XXXXXXXXXXXXX             # ì‹œí¬ë¦¿ í‚¤ (ì ˆëŒ€ ë…¸ì¶œ ê¸ˆì§€)
TOSS_WIDGET_CLIENT_KEY=test_gck_XXXXXXXXXXXXX     # ìœ„ì ¯ í´ë¼ì´ì–¸íŠ¸ í‚¤ (ê³µê°œ)

# í”„ë¡œë•ì…˜ì—ì„œëŠ” 'test_' ì ‘ë‘ì‚¬ ì œê±°
```

**ë³´ì•ˆ ê·œì¹™:**
- âœ… í´ë¼ì´ì–¸íŠ¸ í‚¤(`NEXT_PUBLIC_*`)ëŠ” í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì‚¬ìš© ê°€ëŠ¥
- âŒ ì‹œí¬ë¦¿ í‚¤ëŠ” ë°˜ë“œì‹œ ì„œë²„ ì‚¬ì´ë“œ ì½”ë“œì—ì„œë§Œ ì‚¬ìš© (API ë¼ìš°íŠ¸, ì„œë²„ ì•¡ì…˜)
- âŒ ì‹œí¬ë¦¿ í‚¤ë¥¼ ì ˆëŒ€ ë¡œê·¸ì— ë‚¨ê¸°ì§€ ì•Šê¸°
- âŒ `.env.local`ì„ ë²„ì „ ê´€ë¦¬ì— ì ˆëŒ€ ì»¤ë°‹í•˜ì§€ ì•Šê¸°

## ğŸ¨ ê²°ì œìœ„ì ¯ í†µí•© (ê¶Œì¥)

ê²°ì œìœ„ì ¯ì€ ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš© ì‚¬ë¡€ì— ê¶Œì¥ë˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ë‹¤ìŒì„ ì œê³µí•©ë‹ˆë‹¤:
- ì‚¬ì „ êµ¬ì¶•ëœ ìµœì í™”ëœ UI ì»´í¬ë„ŒíŠ¸
- ìë™ PCI-DSS ì¤€ìˆ˜
- ì–´ë“œë¯¼ íŒ¨ë„ì„ í†µí•œ ì‰¬ìš´ ì»¤ìŠ¤í„°ë§ˆì´ì§•
- ë‹¤ì–‘í•œ ê²°ì œìˆ˜ë‹¨ ì§€ì›

### ê¸°ë³¸ ìœ„ì ¯ ì„¤ì •

```typescript
// app/checkout/page.tsx
'use client';

import { useEffect, useRef } from 'react';
import { loadPaymentWidget, PaymentWidgetInstance } from '@tosspayments/payment-widget-sdk';

export default function CheckoutPage() {
  const paymentWidgetRef = useRef<PaymentWidgetInstance | null>(null);
  const paymentMethodsWidgetRef = useRef<ReturnType<PaymentWidgetInstance['renderPaymentMethods']> | null>(null);

  useEffect(() => {
    (async () => {
      try {
        // 1. ê²°ì œìœ„ì ¯ ë¡œë“œ
        const paymentWidget = await loadPaymentWidget(
          process.env.NEXT_PUBLIC_TOSS_WIDGET_CLIENT_KEY!,
          'CUSTOMER_KEY' // ê³ ìœ í•œ ê³ ê° ì‹ë³„ì (ìœ ì € ID, ì´ë©”ì¼ ë“±)
        );

        paymentWidgetRef.current = paymentWidget;

        // 2. ê²°ì œìˆ˜ë‹¨ UI ë Œë”ë§
        const paymentMethodsWidget = paymentWidget.renderPaymentMethods(
          '#payment-widget',
          { value: 50000 }, // ê²°ì œ ê¸ˆì•¡ (ì›)
          { variantKey: 'DEFAULT' } // ì–´ë“œë¯¼ì—ì„œ ì„¤ì •í•œ UI ë³€í˜•
        );

        paymentMethodsWidgetRef.current = paymentMethodsWidget;

        // 3. ì´ìš©ì•½ê´€ ì²´í¬ë°•ìŠ¤ ë Œë”ë§
        paymentWidget.renderAgreement('#agreement');

      } catch (error) {
        console.error('ê²°ì œìœ„ì ¯ ë¡œë“œ ì‹¤íŒ¨:', error);
        // ì‚¬ìš©ì ì¹œí™”ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
      }
    })();
  }, []);

  const handlePayment = async () => {
    const paymentWidget = paymentWidgetRef.current;

    if (!paymentWidget) {
      alert('ê²°ì œ ìœ„ì ¯ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.');
      return;
    }

    try {
      // ê²°ì œ ìš”ì²­
      await paymentWidget.requestPayment({
        orderId: generateOrderId(), // ê³ ìœ í•œ ì£¼ë¬¸ ID (6-64ì)
        orderName: 'í† ìŠ¤ í‹°ì…”ì¸  ì™¸ 2ê±´',
        customerName: 'ê¹€í† ìŠ¤',
        customerEmail: 'customer@example.com',
        customerMobilePhone: '01012341234',
        successUrl: `${window.location.origin}/payment/success`,
        failUrl: `${window.location.origin}/payment/fail`,
      });
    } catch (error) {
      console.error('ê²°ì œ ìš”ì²­ ì‹¤íŒ¨:', error);
      // ê²°ì œ ìš”ì²­ ì—ëŸ¬ ì²˜ë¦¬
    }
  };

  return (
    <div className="max-w-2xl mx-auto p-6">
      <h1 className="text-2xl font-bold mb-6">ì£¼ë¬¸/ê²°ì œ</h1>

      {/* ê²°ì œìˆ˜ë‹¨ì´ ì—¬ê¸°ì— ë Œë”ë§ë©ë‹ˆë‹¤ */}
      <div id="payment-widget" className="mb-4" />

      {/* ì´ìš©ì•½ê´€ ì²´í¬ë°•ìŠ¤ê°€ ì—¬ê¸°ì— ë Œë”ë§ë©ë‹ˆë‹¤ */}
      <div id="agreement" className="mb-4" />

      <button
        onClick={handlePayment}
        className="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700"
      >
        ê²°ì œí•˜ê¸°
      </button>
    </div>
  );
}

// ê³ ìœ í•œ ì£¼ë¬¸ ID ìƒì„± (ìì²´ ë¡œì§ êµ¬í˜„)
function generateOrderId(): string {
  return `ORDER_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;
}
```

### ì„±ê³µ í˜ì´ì§€ - ê²°ì œ ê²€ì¦

**ì¤‘ìš”**: ì‚¬ê¸° ë°©ì§€ë¥¼ ìœ„í•´ ë°˜ë“œì‹œ ì„œë²„ ì¸¡ì—ì„œ ê²°ì œë¥¼ ê²€ì¦í•˜ì„¸ìš”!

```typescript
// app/payment/success/page.tsx
'use client';

import { useEffect, useState } from 'react';
import { useSearchParams } from 'next/navigation';

export default function PaymentSuccessPage() {
  const searchParams = useSearchParams();
  const [verifying, setVerifying] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const verifyPayment = async () => {
      const paymentKey = searchParams.get('paymentKey');
      const orderId = searchParams.get('orderId');
      const amount = searchParams.get('amount');

      if (!paymentKey || !orderId || !amount) {
        setError('ê²°ì œ ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        setVerifying(false);
        return;
      }

      try {
        // API ë¼ìš°íŠ¸ë¥¼ í˜¸ì¶œí•˜ì—¬ ê²°ì œ ê²€ì¦
        const response = await fetch('/api/payment/verify', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ paymentKey, orderId, amount }),
        });

        if (!response.ok) {
          throw new Error('ê²°ì œ ê²€ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        }

        const data = await response.json();

        // ê²°ì œ ê²€ì¦ ì„±ê³µ
        setVerifying(false);

      } catch (err) {
        console.error('ê²°ì œ ê²€ì¦ ì‹¤íŒ¨:', err);
        setError('ê²°ì œ ê²€ì¦ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        setVerifying(false);
      }
    };

    verifyPayment();
  }, [searchParams]);

  if (verifying) {
    return <div>ê²°ì œ ì •ë³´ë¥¼ í™•ì¸í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>;
  }

  if (error) {
    return <div>ì˜¤ë¥˜: {error}</div>;
  }

  return (
    <div>
      <h1>ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</h1>
      <p>ì£¼ë¬¸ë²ˆí˜¸: {searchParams.get('orderId')}</p>
    </div>
  );
}
```

### ì„œë²„ ì¸¡ ê²°ì œ ê²€ì¦ (API ë¼ìš°íŠ¸)

```typescript
// app/api/payment/verify/route.ts
import { NextRequest, NextResponse } from 'next/server';

export async function POST(request: NextRequest) {
  try {
    const { paymentKey, orderId, amount } = await request.json();

    // 1. ì…ë ¥ê°’ ê²€ì¦
    if (!paymentKey || !orderId || !amount) {
      return NextResponse.json(
        { error: 'í•„ìˆ˜ íŒŒë¼ë¯¸í„°ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤' },
        { status: 400 }
      );
    }

    // 2. í† ìŠ¤í˜ì´ë¨¼ì¸  API í˜¸ì¶œí•˜ì—¬ ê²°ì œ ìŠ¹ì¸
    const secretKey = process.env.TOSS_SECRET_KEY!;
    const encodedKey = Buffer.from(`${secretKey}:`).toString('base64');

    const response = await fetch(
      'https://api.tosspayments.com/v1/payments/confirm',
      {
        method: 'POST',
        headers: {
          'Authorization': `Basic ${encodedKey}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          paymentKey,
          orderId,
          amount: Number(amount),
        }),
      }
    );

    if (!response.ok) {
      const errorData = await response.json();
      console.error('í† ìŠ¤í˜ì´ë¨¼ì¸  API ì—ëŸ¬:', errorData);
      return NextResponse.json(
        { error: errorData.message || 'ê²°ì œ ìŠ¹ì¸ ì‹¤íŒ¨' },
        { status: response.status }
      );
    }

    const paymentData = await response.json();

    // 3. ê²°ì œ ë°ì´í„° ê²€ì¦
    if (paymentData.orderId !== orderId || paymentData.totalAmount !== Number(amount)) {
      console.error('ê²°ì œ ë°ì´í„° ë¶ˆì¼ì¹˜:', { expected: { orderId, amount }, received: paymentData });
      return NextResponse.json(
        { error: 'ê²°ì œ ë°ì´í„° ë¶ˆì¼ì¹˜' },
        { status: 400 }
      );
    }

    // 4. ë°ì´í„°ë² ì´ìŠ¤ì— ê²°ì œ ë°ì´í„° ì €ì¥
    // await db.payments.create({ ...paymentData });

    // 5. ì„±ê³µ ì‘ë‹µ ë°˜í™˜
    return NextResponse.json({
      success: true,
      payment: paymentData,
    });

  } catch (error) {
    console.error('ê²°ì œ ê²€ì¦ ì—ëŸ¬:', error);
    return NextResponse.json(
      { error: 'ë‚´ë¶€ ì„œë²„ ì˜¤ë¥˜' },
      { status: 500 }
    );
  }
}
```

## ğŸ’³ ê²°ì œìˆ˜ë‹¨ ì§€ì›

### ì¹´ë“œ ê²°ì œ
```typescript
// ê²°ì œìœ„ì ¯ì—ì„œ ìë™ìœ¼ë¡œ ì§€ì›ë¨
// í• ë¶€ ì˜µì…˜ì€ ì–´ë“œë¯¼ íŒ¨ë„ì—ì„œ ì„¤ì • ê°€ëŠ¥
```

### ê°€ìƒê³„ì¢Œ
```typescript
// ì…ê¸ˆ ì•Œë¦¼ì„ ë°›ê¸° ìœ„í•´ ì›¹í›… ì„¤ì • í•„ìš”
// í† ìŠ¤í˜ì´ë¨¼ì¸  ì–´ë“œë¯¼ì—ì„œ ì›¹í›… URL ì„¤ì •: https://developers.tosspayments.com

// ì›¹í›… í•¸ë“¤ëŸ¬ ì˜ˆì œ
// app/api/payment/webhook/route.ts
export async function POST(request: NextRequest) {
  const webhookData = await request.json();

  if (webhookData.eventType === 'PAYMENT_STATUS_CHANGED') {
    // ê°€ìƒê³„ì¢Œ ì…ê¸ˆ ì™„ë£Œ
    const { orderId, status } = webhookData.data;

    if (status === 'DONE') {
      // ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸
      // ê³ ê°ì—ê²Œ í™•ì¸ ì´ë©”ì¼ ë°œì†¡
    }
  }

  return NextResponse.json({ received: true });
}
```

### íœ´ëŒ€í° ê²°ì œ
```typescript
// ê²°ì œìœ„ì ¯ì—ì„œ ìë™ìœ¼ë¡œ ì§€ì›ë¨
// ì¼ë¶€ ê°€ë§¹ì ì€ ì—°ë ¹ ì¸ì¦ í•„ìš”
```

### ê°„í¸ê²°ì œ
```typescript
// ì§€ì›: í† ìŠ¤í˜ì´, ë„¤ì´ë²„í˜ì´, ì¹´ì¹´ì˜¤í˜ì´, ì‚¼ì„±í˜ì´ ë“±
// ì–´ë“œë¯¼ì—ì„œ ì„¤ì • ì‹œ ìë™ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥
```

### PayPal í†µí•©
```typescript
// ê²°ì œìœ„ì ¯ì—ì„œ PayPal í™œì„±í™”
const paymentWidget = await loadPaymentWidget(
  clientKey,
  customerKey,
  { locale: 'en' } // í•´ì™¸ ê³ ê°ì„ ìœ„í•œ ì˜ì–´ ì„¤ì •
);

// PayPalì´ ìë™ìœ¼ë¡œ ê²°ì œ ì˜µì…˜ìœ¼ë¡œ í‘œì‹œë¨
```

## ğŸ”„ ìë™ê²°ì œ(ë¹Œë§) / êµ¬ë…

### ë¹Œë§í‚¤ ë°œê¸‰

```typescript
// app/billing/register/page.tsx
'use client';

import { loadBillingWidget } from '@tosspayments/billing-widget-sdk';

export default function RegisterBillingPage() {
  const handleRegisterBilling = async () => {
    try {
      const billingWidget = await loadBillingWidget(
        process.env.NEXT_PUBLIC_TOSS_CLIENT_KEY!,
        'CUSTOMER_KEY'
      );

      await billingWidget.requestBillingAuth({
        method: 'CARD', // ë˜ëŠ” ê³„ì¢Œì´ì²´ì˜ ê²½ìš° 'TRANSFER'
        successUrl: `${window.location.origin}/billing/success`,
        failUrl: `${window.location.origin}/billing/fail`,
        customerEmail: 'customer@example.com',
        customerName: 'ê¹€í† ìŠ¤',
      });
    } catch (error) {
      console.error('ë¹Œë§ ë“±ë¡ ì‹¤íŒ¨:', error);
    }
  };

  return (
    <button onClick={handleRegisterBilling}>
      ì¹´ë“œ ë“±ë¡í•˜ê¸°
    </button>
  );
}
```

### ë¹Œë§ ê²°ì œ ì²˜ë¦¬ (ì„œë²„ ì¸¡)

```typescript
// app/api/billing/charge/route.ts
export async function POST(request: NextRequest) {
  const { billingKey, amount, orderId, orderName } = await request.json();

  const secretKey = process.env.TOSS_SECRET_KEY!;
  const encodedKey = Buffer.from(`${secretKey}:`).toString('base64');

  const response = await fetch(
    `https://api.tosspayments.com/v1/billing/${billingKey}`,
    {
      method: 'POST',
      headers: {
        'Authorization': `Basic ${encodedKey}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        amount,
        orderId,
        orderName,
        customerName: 'ê¹€í† ìŠ¤',
      }),
    }
  );

  const data = await response.json();

  if (!response.ok) {
    return NextResponse.json({ error: data }, { status: response.status });
  }

  return NextResponse.json({ success: true, payment: data });
}
```

## ğŸ” ë³´ì•ˆ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

### 1. API í‚¤ ê´€ë¦¬
```typescript
// âœ… ì¢‹ìŒ - ì„œë²„ ì¸¡ì—ì„œë§Œ ì‚¬ìš©
const secretKey = process.env.TOSS_SECRET_KEY;

// âŒ ë‚˜ì¨ - í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€
const secretKey = 'test_sk_XXXXXXXXXXXXX';
```

### 2. ê²°ì œ ê¸ˆì•¡ ê²€ì¦
```typescript
// ê²°ì œ ê¸ˆì•¡ì´ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í•­ìƒ ê²€ì¦
async function verifyPayment(orderId: string, receivedAmount: number) {
  const order = await db.orders.findUnique({ where: { id: orderId } });

  if (order.totalAmount !== receivedAmount) {
    throw new Error('ê¸ˆì•¡ ë¶ˆì¼ì¹˜ - ì‚¬ê¸° ì‹œë„ ê°€ëŠ¥ì„±');
  }

  return true;
}
```

### 3. ë©±ë“±ì„± ë³´ì¥
```typescript
// ì¤‘ë³µ ê²°ì œ ë°©ì§€ë¥¼ ìœ„í•œ ë©±ë“±ì„± í‚¤ ì‚¬ìš©
const response = await fetch('https://api.tosspayments.com/v1/payments/confirm', {
  headers: {
    'Idempotency-Key': `payment-${orderId}-${Date.now()}`,
    // ... ê¸°íƒ€ í—¤ë”
  },
  // ... ë‚˜ë¨¸ì§€ ìš”ì²­
});
```

## âŒ ì—ëŸ¬ ì²˜ë¦¬

### ì¼ë°˜ì ì¸ ì—ëŸ¬ ì½”ë“œ

```typescript
const TOSS_ERROR_CODES = {
  // ê²°ì œ ì—ëŸ¬
  'INVALID_CARD_NUMBER': 'ìœ íš¨í•˜ì§€ ì•Šì€ ì¹´ë“œë²ˆí˜¸ì…ë‹ˆë‹¤.',
  'INVALID_CARD_EXPIRATION': 'ì¹´ë“œ ìœ íš¨ê¸°ê°„ì„ í™•ì¸í•´ì£¼ì„¸ìš”.',
  'INVALID_CARD_INSTALLMENT_PLAN': 'í• ë¶€ ê°œì›” ìˆ˜ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.',
  'NOT_ENOUGH_BALANCE': 'ì”ì•¡ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.',
  'EXCEED_MAX_AMOUNT': 'ê²°ì œ ê°€ëŠ¥ ê¸ˆì•¡ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.',

  // ë¹Œë§ ì—ëŸ¬
  'ALREADY_REGISTERED_BILLING_KEY': 'ì´ë¯¸ ë“±ë¡ëœ ì¹´ë“œì…ë‹ˆë‹¤.',
  'INVALID_BILLING_KEY': 'ìœ íš¨í•˜ì§€ ì•Šì€ ë¹Œë§í‚¤ì…ë‹ˆë‹¤.',

  // ê³µí†µ ì—ëŸ¬
  'INVALID_REQUEST': 'ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤.',
  'UNAUTHORIZED': 'ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',
  'NOT_FOUND': 'ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²°ì œì…ë‹ˆë‹¤.',
} as const;

// ì—ëŸ¬ ì²˜ë¦¬ ë˜í¼
async function handleTossPaymentError(error: any) {
  const errorCode = error.code;
  const message = TOSS_ERROR_CODES[errorCode as keyof typeof TOSS_ERROR_CODES]
    || 'ê²°ì œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';

  // ë””ë²„ê¹…ì„ ìœ„í•œ ì—ëŸ¬ ë¡œê·¸
  console.error('í† ìŠ¤í˜ì´ë¨¼ì¸  ì—ëŸ¬:', { code: errorCode, message: error.message });

  // ì‚¬ìš©ì ì¹œí™”ì ì¸ ë©”ì‹œì§€ í‘œì‹œ
  return message;
}
```

## ğŸ§ª í…ŒìŠ¤íŠ¸

### í…ŒìŠ¤íŠ¸ ì¹´ë“œ ë²ˆí˜¸

```typescript
// í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì¹´ë“œ ë²ˆí˜¸ (ìƒŒë“œë°•ìŠ¤ í™˜ê²½ì—ì„œ ì‚¬ìš©)
const TEST_CARDS = {
  SUCCESS: '4330123456789012', // ê²°ì œ ì„±ê³µ
  FAIL_INVALID: '4330123456789013', // ìœ íš¨í•˜ì§€ ì•Šì€ ì¹´ë“œ
  FAIL_BALANCE: '4330123456789014', // ì”ì•¡ ë¶€ì¡±
  FAIL_LIMIT: '4330123456789015', // í•œë„ ì´ˆê³¼
};

// í…ŒìŠ¤íŠ¸ ìê²©ì¦ëª… í˜•ì‹
const TEST_CLIENT_KEY = 'test_ck_XXXXXXXXXXXXX';
const TEST_SECRET_KEY = 'test_sk_XXXXXXXXXXXXX';
```

### í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ê²°ì œìœ„ì ¯ì´ ì˜¬ë°”ë¥´ê²Œ ë¡œë“œë¨
- [ ] ëª¨ë“  ê²°ì œìˆ˜ë‹¨ì´ í‘œì‹œë¨
- [ ] ê²°ì œ ì„±ê³µ í”Œë¡œìš°ê°€ ì‘ë™í•¨
- [ ] ê²°ì œ ì‹¤íŒ¨ê°€ ìš°ì•„í•˜ê²Œ ì²˜ë¦¬ë¨
- [ ] ì„œë²„ ì¸¡ ê²€ì¦ì´ ì‘ë™í•¨
- [ ] ì›¹í›…ì´ ì•Œë¦¼ì„ ë°›ìŒ (ê°€ìƒê³„ì¢Œìš©)
- [ ] ì—ëŸ¬ ë©”ì‹œì§€ê°€ ì‚¬ìš©ì ì¹œí™”ì ì„
- [ ] ëª¨ë°”ì¼ ë°˜ì‘í˜• ë””ìì¸
- [ ] ë¹Œë§í‚¤ ë“±ë¡ì´ ì‘ë™í•¨
- [ ] ìë™ ê²°ì œ ì²˜ë¦¬ê°€ ì‘ë™í•¨

## ğŸ“± ëª¨ë°”ì¼ & ì›¹ë·° í†µí•©

### ì›¹ë·° ì„¤ì •

```typescript
// React Native WebViewìš©
import { WebView } from 'react-native-webview';

<WebView
  source={{ uri: 'https://your-domain.com/checkout' }}
  onNavigationStateChange={(navState) => {
    // ì•± ìŠ¤í‚´ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²˜ë¦¬
    if (navState.url.startsWith('supertoss://')) {
      // í† ìŠ¤í˜ì´ ì•± ìŠ¤í‚´ ì²˜ë¦¬
      Linking.openURL(navState.url);
      return false;
    }
  }}
  onShouldStartLoadWithRequest={(request) => {
    // ê²°ì œ ì•± ìŠ¤í‚´ ì²˜ë¦¬
    const schemes = ['ispmobile://', 'hdcardappcardansimclick://', 'shinhan-sr-ansimclick://'];

    for (const scheme of schemes) {
      if (request.url.startsWith(scheme)) {
        Linking.openURL(request.url);
        return false;
      }
    }

    return true;
  }}
/>
```

## ğŸ”„ ê²°ì œ ì·¨ì†Œ

### ì „ì²´/ë¶€ë¶„ í™˜ë¶ˆ

```typescript
// app/api/payment/cancel/route.ts
export async function POST(request: NextRequest) {
  const { paymentKey, cancelReason, cancelAmount } = await request.json();

  const secretKey = process.env.TOSS_SECRET_KEY!;
  const encodedKey = Buffer.from(`${secretKey}:`).toString('base64');

  const response = await fetch(
    `https://api.tosspayments.com/v1/payments/${paymentKey}/cancel`,
    {
      method: 'POST',
      headers: {
        'Authorization': `Basic ${encodedKey}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        cancelReason,
        // ë¶€ë¶„ í™˜ë¶ˆì˜ ê²½ìš° cancelAmount í¬í•¨, ì „ì²´ í™˜ë¶ˆì˜ ê²½ìš° ìƒëµ
        ...(cancelAmount && { cancelAmount }),
      }),
    }
  );

  const data = await response.json();

  if (!response.ok) {
    return NextResponse.json({ error: data }, { status: response.status });
  }

  return NextResponse.json({ success: true, cancellation: data });
}
```

## ğŸ“Š ì„¸ê¸ˆ ì²˜ë¦¬

### ë©´ì„¸ ìƒí’ˆ

```typescript
// ë©´ì„¸ ìƒí’ˆìœ¼ë¡œ ê²°ì œ ìš”ì²­ ì‹œ
await paymentWidget.requestPayment({
  orderId: 'ORDER_123',
  orderName: 'ë„ì„œ êµ¬ë§¤',
  amount: 10000,
  taxFreeAmount: 10000, // ë„ì„œëŠ” ì „ì•¡ ë©´ì„¸
  // ... ê¸°íƒ€ íŒŒë¼ë¯¸í„°
});
```

## ğŸ¯ ì¼ë°˜ì ì¸ í†µí•© íŒ¨í„´

### íŒ¨í„´ 1: ì´ì»¤ë¨¸ìŠ¤ ì²´í¬ì•„ì›ƒ

```typescript
// 1. ë°ì´í„°ë² ì´ìŠ¤ì— ì£¼ë¬¸ ìƒì„±
const order = await createOrder({ items, userId });

// 2. ì£¼ë¬¸ ê¸ˆì•¡ìœ¼ë¡œ ê²°ì œìœ„ì ¯ ì´ˆê¸°í™”
const paymentWidget = await loadPaymentWidget(clientKey, userId);
paymentWidget.renderPaymentMethods('#payment-widget', {
  value: order.totalAmount
});

// 3. ì£¼ë¬¸ ìƒì„¸ì •ë³´ë¡œ ê²°ì œ ìš”ì²­
await paymentWidget.requestPayment({
  orderId: order.id,
  orderName: order.name,
  amount: order.totalAmount,
  // ... ë¦¬ë‹¤ì´ë ‰íŠ¸ URL
});

// 4. ì„±ê³µ í˜ì´ì§€ì—ì„œ ê²°ì œ ê²€ì¦
// 5. ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸
// 6. í™•ì¸ ì´ë©”ì¼ ë°œì†¡
```

### íŒ¨í„´ 2: êµ¬ë… ì„œë¹„ìŠ¤

```typescript
// 1. ë¹Œë§í‚¤ ë“±ë¡ (ìµœì´ˆ 1íšŒ)
const billingKey = await registerBillingKey(userId);

// 2. ìë™ ê²°ì œ ìŠ¤ì¼€ì¤„ë§
cron.schedule('0 0 1 * *', async () => {
  const subscriptions = await getActiveSubscriptions();

  for (const sub of subscriptions) {
    await chargeBilling({
      billingKey: sub.billingKey,
      amount: sub.plan.price,
      orderId: generateOrderId(),
    });
  }
});
```

## ğŸ”§ ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œ

1. **ê²°ì œìœ„ì ¯ì´ ë¡œë“œë˜ì§€ ì•ŠìŒ**
   - í´ë¼ì´ì–¸íŠ¸ í‚¤ê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸
   - ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
   - ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì—ëŸ¬ í™•ì¸
   - CDNì´ ì°¨ë‹¨ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸

2. **ê²°ì œ ê²€ì¦ ì‹¤íŒ¨**
   - ì‹œí¬ë¦¿ í‚¤ê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸
   - API ì—”ë“œí¬ì¸íŠ¸ì— ì ‘ê·¼ ê°€ëŠ¥í•œì§€ í™•ì¸
   - ê¸ˆì•¡ì´ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
   - ì„œë²„ ë¡œê·¸ì—ì„œ ìì„¸í•œ ì—ëŸ¬ í™•ì¸

3. **ì›¹í›…ì„ ë°›ì§€ ëª»í•¨**
   - ì›¹í›… URLì´ ê³µê°œì ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•œì§€ í™•ì¸
   - ì–´ë“œë¯¼ì— ì›¹í›…ì´ ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
   - ì—”ë“œí¬ì¸íŠ¸ê°€ 200 ìƒíƒœë¥¼ ë°˜í™˜í•˜ëŠ”ì§€ í™•ì¸
   - ë°©í™”ë²½ ì„¤ì • í™•ì¸

## ğŸ“š ì¶”ê°€ ë¦¬ì†ŒìŠ¤

- ê³µì‹ ë¬¸ì„œ: https://docs.tosspayments.com
- API ë ˆí¼ëŸ°ìŠ¤: https://docs.tosspayments.com/reference
- ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ: https://dashboard.tosspayments.com
- ê°œë°œìì„¼í„°: https://developers.tosspayments.com
- LLM í†µí•© ê°€ì´ë“œ: https://docs.tosspayments.com/guides/v2/get-started/llms-guide
- ì½”ë“œ ì˜ˆì œ: https://github.com/tosspayments

## ğŸš€ ë¹ ë¥¸ ì‹œì‘ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] í•„ìˆ˜ ì˜ì¡´ì„± ì„¤ì¹˜
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- [ ] ê²°ì œìœ„ì ¯ìœ¼ë¡œ ì²´í¬ì•„ì›ƒ í˜ì´ì§€ êµ¬í˜„
- [ ] ì„±ê³µ/ì‹¤íŒ¨ ë¦¬ë‹¤ì´ë ‰íŠ¸ í˜ì´ì§€ ìƒì„±
- [ ] ì„œë²„ ì¸¡ ê²°ì œ ê²€ì¦ êµ¬í˜„
- [ ] ì›¹í›… ì—”ë“œí¬ì¸íŠ¸ ì„¤ì • (ê°€ìƒê³„ì¢Œ ì‚¬ìš© ì‹œ)
- [ ] í…ŒìŠ¤íŠ¸ ì¹´ë“œë¡œ í…ŒìŠ¤íŠ¸
- [ ] í”„ë¡œë•ì…˜ í‚¤ ì„¤ì •
- [ ] ë°°í¬ í›„ í”„ë¡œë•ì…˜ì—ì„œ í…ŒìŠ¤íŠ¸

---

**ê¸°ì–µí•˜ì„¸ìš”**: í”„ë¡œë•ì…˜ ë°°í¬ ì „ì— ìƒŒë“œë°•ìŠ¤ í™˜ê²½ì—ì„œ ì² ì €íˆ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”!

Cursor ì‚¬ìš©ìë¥¼ ìœ„í•œ íŒ: ê²°ì œ ê¸°ëŠ¥ êµ¬í˜„ ì‹œ ìµœì‹  í†µí•© íŒ¨í„´ì„ ìœ„í•´ @tosspaymentsë¥¼ ì°¸ì¡°í•˜ì—¬ MCP ì»¨í…ìŠ¤íŠ¸ë¥¼ í™œìš©í•˜ì„¸ìš”.
